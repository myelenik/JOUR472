---
title: "Reverse Engineering Project"
author: "Kenan Grier, Marissa Yelenik, Matthew Kiras, Nicholas Wolcott"
date: "Date here"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)
options(scipen=999)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

```{r}

md_state_payments <- read_csv("data/State_of_Maryland_Payments_Data__FY2008_to_FY2024.csv") |> clean_names()


```

### Limitations

rows:

columns:

limitations: what is an industry

code: categories? industry

no problems on timeframe

### Question 1: How does the distribution of spending change from year to year?

```{r}

md_state_payments_by_year <- md_state_payments |>
  group_by(fiscal_year) |>
  summarise(total = sum(amount)) |>
  arrange(desc(total))

md_state_payments_by_year |>
  ggplot() +
  geom_bar(aes(x=reorder(fiscal_year,total), weight=total)) +
  coord_flip() +
    labs(
    title="Maryland Payments by Year",
    x = "Payment Value",
    y = "Year",
  )

```

```{r}
# Put code to reverse engineer sentence here


private_enrollment_by_grade |>
  mutate(
    term = case_when(
      str_detect(sch_year, "2019-2020") ~ "2019",
      str_detect(sch_year, "2020-2021") ~ "2020",
      str_detect(sch_year, "2021-2022") ~ "2021",
      .default = NA
    )) |>
  filter(enrollment_type == 'Private enrollment') |>
  group_by(state, term) |>
  summarise( state_enrollment= sum(enrollment)) 


# |>
filter(enrollment_type == 'Private enrollment') |>
#  mutate(total_private_change = sum('2021') - sum('2019')) |> 
#  summarize(sum(total_private_change))
  

  
# Display results of code below this codeblock

```

### Sentence 2

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here
 private_enrollment_by_grade |>
  group_by(state) |>
  arrange(desc(enrollment))
# Display results of code below this codeblock

```

### Sentence 3

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Sentence 4

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here
enrollment_changes |>
  group_by(enrollment_type) |>
  filter(enrollment_type == 'Private enrollment') |>
  filter(state_abbrev == 'CA' | state_abbrev == 'NY' | state_abbrev == 'LA' | state_abbrev == 'NC' | state_abbrev == 'WA' | state_abbrev == 'CO' | state_abbrev == 'GA' | state_abbrev == 'MN' | state_abbrev == 'WI' | state_abbrev == 'NH' | state_abbrev == 'MA' | state_abbrev == 'MT' | state_abbrev == 'DE' | state_abbrev == 'ND' | state_abbrev == 'DC' | state_abbrev == 'SD' | state_abbrev == 'SC' | state_abbrev == 'NE' | state_abbrev == 'RI' | state_abbrev == 'TN' | state_abbrev == 'PA' | state_abbrev == 'FL') |>
  mutate(private_year_19_20 = sum(school_year_2019_20)) |>   
  mutate(private_year_20_21 = sum(school_year_2020_2021)) |>
  mutate(private_year_21_22 = sum(school_year_2021_22)) |>
  mutate(total_private_change = private_year_21_22 - private_year_19_20) |> 
  summarize(sum(total_change))
  

enrollment_changes |>
  group_by(enrollment_type) |>
  filter(enrollment_type == 'Homeschool enrollment') |>
  filter(state_abbrev == 'CA' | state_abbrev == 'NY' | state_abbrev == 'LA' | state_abbrev == 'NC' | state_abbrev == 'WA' | state_abbrev == 'CO' | state_abbrev == 'GA' | state_abbrev == 'MN' | state_abbrev == 'WI' | state_abbrev == 'NH' | state_abbrev == 'MA' | state_abbrev == 'MT' | state_abbrev == 'DE' | state_abbrev == 'ND' | state_abbrev == 'DC' | state_abbrev == 'SD' | state_abbrev == 'SC' | state_abbrev == 'NE' | state_abbrev == 'RI' | state_abbrev == 'TN' | state_abbrev == 'PA' | state_abbrev == 'FL') |>
  mutate(homeschool_year_19_20 = sum(school_year_2019_20)) |>   
  mutate(homeschool_year_20_21 = sum(school_year_2020_2021)) |>
  mutate(homeschool_year_21_22 = sum(school_year_2021_22)) |>
  mutate(total_homeschool_change = homeschool_year_21_22 - homeschool_year_19_20) |> 
  summarize(sum(total_change))

# Display results of code below this codeblock

```

### Sentence 5

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

-30-
